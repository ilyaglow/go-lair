package lair

// Vulnerability contains all the needed information for a single
// vulnerability in a project.
type Vulnerability struct {
	Id             string              `json:"_id" bson:"_id"`
	ProjectId      string              `json:"project_id" bson:"project_id"`
	Title          string              `json:"title" bson:"title"`
	Description    string              `json:"description" bson:"description"`
	Solution       string              `json:"solution" bson:"solution"`
	Evidence       string              `json:"evidence" bson:"evidence"`
	Status         string              `json:"status" bson:"status"`
	Cvss           float64             `json:"cvss" bson:"cvss"`
	Cves           []string            `json:"cves" bson:"cves"`
	PluginIds      []PluginId          `json:"plugin_ids" bson:"plugin_ids"`
	IdentifiedBy   []string            `json:"identified_by" bson:"identified_by"`
	Confirmed      bool                `json:"confirmed" bson:"confirmed"`
	Notes          []Note              `json:"notes" bson:"notes"`
	Hosts          []VulnerabilityHost `json:"hosts" bson:"hosts"`
	LastModifiedBy string              `json:"last_modified_by "bson:"last_modified_by"`
	Flag           bool                `json:"flag" bson:"flag"`
}

// VulnerabilityHost is a single host record for a vulnerability.
type VulnerabilityHost struct {
	StringAddr string `json:"string_addr" bson:"string_addr"`
	Port       int    `json:"port" bson:"port"`
	Protocol   string `json:"protocol" bson:"protocol"`
}

// PluginId is used to store a id from an automated tool.
type PluginId struct {
	Tool string `json:"tool" bson:"tool"`
	Id   string `json:"id" bson:"id"`
}
